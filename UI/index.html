<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>Hash Cache</title>
    <link href="css/bootstrap.css" rel="stylesheet">
  </head>
  <body>
    <div id="wrapper">
      <div id="sidebar-wrapper">
        <ul class="sidebar-nav">
          <li class="sidebar-brand">
            <a href="#">
            Hash Cache
            </a>
          </li>
          <li>
            <a href="#" id="insert-toggle">Insert</a>
          </li>
          <li>
            <a href="#" id="search-toggle">Search</a>
          </li>
          <li>
            <a href="#" id="recent-toggle">Recent</a>
          </li>
          <li>
            <a href="#" id="about-toggle">About</a>
          </li>
        </ul>
      </div>
      <div id="page-content-wrapper">
        <div class="container-fluid" id="insert">
          <div class="row">
            <div class="col-lg-12">
              <h1>Insert</h1>
              <article>
                <div id="holder">
                </div>
                <p id="upload" class="hidden"><label>Drag & drop not supported, but you can still upload via this input field:<br><input type="file"></label></p>
                <p id="filereader">File API & FileReader API not supported</p>
                <p id="formdata">XHR2's FormData is not supported</p>
                <p id="progress">XHR2's upload progress isn't supported</p>
                <p>Progress: <progress id="uploadprogress" min="0" max="100" value="0">0</progress></p>
              </article>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <h2>
                Result
              </h2>
              <table class="table" id="insert-result">
                <tbody>
                  <tr>
                    <th>State</th>
                    <th>Hash</th>
                    <th>Timestamp</th>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="container-fluid" id="search">
          <div class="row">
            <div class="col-lg-12">
              <h1>Search</h1>
              <article>
                <div id="holder2">
                </div>
                <p id="upload2" class="hidden"><label>Drag & drop not supported, but you can still upload via this input field:<br><input type="file"></label></p>
                <p id="filereader2">File API & FileReader API not supported</p>
                <p id="formdata2">XHR2's FormData is not supported</p>
                <p id="progress2">XHR2's upload progress isn't supported</p>
                <p>Progress: <progress id="uploadprogress2" min="0" max="100" value="0">0</progress></p>
              </article>
            </div>
          </div>
          <div class="row">
            <div class="col-lg-12">
              <h2>
                Result
              </h2>
              <table class="table" id="search-result">
                <tbody>
                  <tr>
                    <th>State</th>
                    <th>Hash</th>
                    <th>Timestamp</th>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="container-fluid" id="recent">
          <div class="row">
            <div class="col-lg-12">
              <h1>Recent</h1>
              <table class="table">
                <tbody>
                  <tr>
                    <th>Hash</th>
                    <th>Timestamp</th>
                  </tr>
                  <tr>
                    <td>07123e1f482356c415f684407a3b8723e10b2cbbc0b8fcd6282c49d37c9c1abc</td>
                    <td>2005-10-30 T 10:45 UTC</td>
                  </tr>
                  <tr>
                    <td>07123e1f482356c415f684407a3b8723e10b2cbbc0b8fcd6282c49d37c9c1abc</td>
                    <td>2005-10-30 T 10:45 UTC</td>
                  </tr>
                  <tr>
                    <td>07123e1f482356c415f684407a3b8723e10b2cbbc0b8fcd6282c49d37c9c1abc</td>
                    <td>2005-10-30 T 10:45 UTC</td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
        <div class="container-fluid" id="about">
          <div class="row">
            <div class="col-lg-12">
              <h1>About</h1>
              <p>Some explaination goes here.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script src="js/jquery.js"></script>
    <script>
      $("#about").hide();
      $("#search").hide();
      $("#recent").hide();
      $("#about-toggle").click(function(e) {
          e.preventDefault();
          $("#about").show();
          $("#insert").hide();
          $("#search").hide();
          $("#recent").hide();
      });
          $("#insert-toggle").click(function(e) {
          e.preventDefault();
          $("#insert").show();
          $("#about").hide();
          $("#search").hide();
          $("#recent").hide();
      });
      $("#search-toggle").click(function(e) {
          e.preventDefault();
          $("#search").show();
          $("#about").hide();
          $("#insert").hide();
          $("#recent").hide();
      });
      $("#recent-toggle").click(function(e) {
          e.preventDefault();
          $("#recent").show();
          $("#about").hide();
          $("#insert").hide();
          $("#search").hide();
      });
    </script>
    <script>
      var holder = document.getElementById('holder'),
          tests = {
            filereader: typeof FileReader != 'undefined',
            dnd: 'draggable' in document.createElement('span'),
            formdata: !!window.FormData,
            progress: "upload" in new XMLHttpRequest
          }, 
          support = {
            filereader: document.getElementById('filereader'),
            formdata: document.getElementById('formdata'),
            progress: document.getElementById('progress')
          },
          acceptedTypes = {
          },
          progress = document.getElementById('uploadprogress'),
          fileupload = document.getElementById('upload');
      
      "filereader formdata progress".split(' ').forEach(function (api) {
        if (tests[api] === false) {
          support[api].className = 'fail';
        } else {
          support[api].className = 'hidden';
        }
      });
      
      function previewfile(file) {
        if (tests.filereader === true && acceptedTypes[file.type] === true) {
          var reader = new FileReader();
          reader.onload = function (event) {
            var image = new Image();
            image.src = event.target.result;
            image.width = 250; // a fake resize
            holder.appendChild(image);
          };
      
          reader.readAsDataURL(file);
        }  else {
          holder.innerHTML += '<p>Uploaded ' + file.name + ' ' + (file.size ? (file.size/1024|0) + 'K' : '');
          console.log(file);
        }
      }
      
      function readfiles(files) {
          debugger;
          var formData = tests.formdata ? new FormData() : null;
          for (var i = 0; i < files.length; i++) {
            if (tests.formdata) formData.append('file', files[i]);
            previewfile(files[i]);
          }

          if (tests.formdata) {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/devnull.php');
            xhr.onload = function() {
              progress.value = progress.innerHTML = 100;
            };
      
            if (tests.progress) {
              xhr.upload.onprogress = function (event) {
                if (event.lengthComputable) {
                  var complete = (event.loaded / event.total * 100 | 0);
                  progress.value = progress.innerHTML = complete;
                }
              }
            }
      $('#insert-result > tbody:last').append('<tr><td>Success</td><td>07123e1f482356c415f684407a3b8723e10b2cbbc0b8fcd6282c49d37c9c1abc</td><td>2005-10-30 T 10:45 UTC</td></tr>');
            xhr.send(formData);
          }
      }
      
      if (tests.dnd) { 
        holder.ondragover = function () { this.className = 'hover'; return false; };
        holder.ondragend = function () { this.className = ''; return false; };
        holder.ondrop = function (e) {
          this.className = '';
          e.preventDefault();
          readfiles(e.dataTransfer.files);
        }
      } else {
        fileupload.className = 'hidden';
        fileupload.querySelector('input').onchange = function () {
          readfiles(this.files);
        };
      }
    </script>
    <script>
      var holder2 = document.getElementById('holder2'),
          tests2 = {
            filereader: typeof FileReader != 'undefined',
            dnd: 'draggable' in document.createElement('span'),
            formdata: !!window.FormData,
            progress: "upload" in new XMLHttpRequest
          }, 
          support2 = {
            filereader: document.getElementById('filereader2'),
            formdata: document.getElementById('formdata2'),
            progress: document.getElementById('progress2')
          },
          acceptedTypes2 = {
          },
          progress2 = document.getElementById('uploadprogress2'),
          fileupload2 = document.getElementById('upload2');
      
      "filereader formdata progress".split(' ').forEach(function (api) {
        if (tests2[api] === false) {
          support2[api].className = 'fail';
        } else {
          support2[api].className = 'hidden';
        }
      });
      
      function previewfile2(file) {
        if (tests2.filereader === true && acceptedTypes2[file.type] === true) {
          var reader = new FileReader();
          reader.onload = function (event) {
            var image = new Image();
            image.src = event.target.result;
            image.width = 250; // a fake resize
            holder2.appendChild(image);
          };
      
          reader.readAsDataURL(file);
        }  else {
          holder2.innerHTML += '<p>Uploaded ' + file.name + ' ' + (file.size ? (file.size/1024|0) + 'K' : '');
          console.log(file);
        }
      }
      
      function readfiles2(files) {
          debugger;
          var formData = tests2.formdata ? new FormData() : null;
          for (var i = 0; i < files.length; i++) {
            if (tests2.formdata) formData.append('file', files[i]);
            previewfile2(files[i]);
          }
      
          if (tests2.formdata) {
            var xhr = new XMLHttpRequest();
            xhr.open('POST', '/devnull.php');
            xhr.onload = function() {
              progress2.value = progress2.innerHTML = 100;
            };
      
            if (tests2.progress2) {
              xhr.upload.onprogress2 = function (event) {
                if (event.lengthComputable) {
                  var complete = (event.loaded / event.total * 100 | 0);
                  progress2.value = progress2.innerHTML = complete;
                }
              }
            }
      $('#search-result > tbody:last').append('<tr><td>Found</td><td>07123e1f482356c415f684407a3b8723e10b2cbbc0b8fcd6282c49d37c9c1abc</td><td>2005-10-30 T 10:45 UTC</td></tr>');
            xhr.send(formData);
          }
      }
      
      if (tests2.dnd) { 
        holder2.ondragover = function () { this.className = 'hover'; return false; };
        holder2.ondragend = function () { this.className = ''; return false; };
        holder2.ondrop = function (e) {
          this.className = '';
          e.preventDefault();
          readfiles2(e.dataTransfer.files);
        }
      } else {
        fileupload2.className = 'hidden';
        fileupload2.querySelector('input').onchange = function () {
          readfiles2(this.files);
        };
      }
    </script>
  </body>
</html>